{% extends "templates/web.html" %}
{% block title %} {{ _("Job Openings") }} {% endblock title %}

{% block header %}
<div class="mb-10">
	<p>Hi, I am Ashwin P, the founders office of AssetPlus hadnling strategy & new intiatives at Assetplus. I am personally reaching out to connect with talented folks from various domains across all roles. If you have an urge to solve hard problems in life and want to make a difference, please reach out to me at <a href="https://www.linkedin.com/in/ashwin-ponnusamy/">LinkedIn.</a></p>
</div>
<h3 class="mt-0 mb-5 jobs-page">{{ _("Job Openings") }}</h3>
{% endblock header %}

{% block page_content %}




<div>
	<div class="row px-4 mb-10 align-items-center">
		<!-- Search  -->
		<div class="col-9 col-lg-8 px-0">
			<div class="input-group search-bar flex text-muted">
				<div class="search-box-container">
					<input
						type="search"
						name="query"
						id="search-box"
						class="form-control border font-md h-100 desktop-filters mobile-filters"
						placeholder="{{ _('Search for Jobs') }}"
						aria-label="Jobs Search"
					/>
				</div>
				<span class="search-icon">
					<svg class="icon icon-sm"><use href="#icon-search"></use></svg>
				</span>
			</div>
		</div>


		<div class="col-3 col-lg-4 flex pr-0">
			<div class="ml-auto flex align-items-center">
				<div class="btn-group border h-100" style="border-radius: 8px">

					<!-- Sort -->
					{% set sort = frappe.form_dict.sort %}
					<button id="sort" class="btn btn-default btn-order bg-white">
						<span class="sort-order">
							<svg class="icon icon-sm">
								<use
									class
									href="#icon-sort-{{ 'ascending' if sort == 'asc' else 'descending' }}"
								></use>
							</svg>
						</span>
					</button>
					<div
						class="border-left px-3 flex align-items-center bg-white d-none d-lg-block"
						style="border-radius: 0px 8px 8px 0px"
					>
						<span class="text-14">{{ _("Posting Date") }}</span>
					</div>

					<!-- Mobile Filter Button -->
					<button
						id="filter"
						class="btn btn-default btn-order bg-white border-left d-lg-none"
					>
						<span class="sort-order">
							<svg class="icon icon-sm">
								<use
									class
									href="#icon-filter"
								></use>
							</svg>
						</span>
					</button>

				</div>
			</div>
		</div>
	</div>

	<!-- Job Opening Cards -->
	<p class="text-secondary mb-4 text-15">
		{% set job_opening_count = job_openings|length %}
		{{ _("Showing") + " " + frappe.utils.cstr(job_opening_count) + " " }}
		{{ _("result") if job_opening_count == 1 else _("results")}}
	</p>

	<div class="row">
		{% for jo in job_openings %}
		<div class="mb-8 col-sm-6">
			<div
				id="{{ jo.route }}"
				name="card"
				class="card border h-100 flex flex-col"
				role="button"
			>
				<div class="p-6">
					<div class="flex mb-5">
						<div class="col-12 {{ 'col-lg-9' if jo.employment_type }} px-0">
							<h4
								class="mt-0 mb-1 jobs-page text-truncate"
								title="{{ jo.job_title }}"
							>
								{{ jo.job_title }}
							</h4>
							<div class="text-14">
								<span class="font-weight-bold">{{ jo.company }}</span>
								<span class="text-secondary">
									{{ " · " }} {{ jo.posted_on }}
								</span>
							</div>
						</div>

						{%- if jo.employment_type -%}
						<div class="col-3 px-0 flex d-none d-lg-flex">
							<div class="ml-auto font-weight-bold text-nowrap text-12">
								{%- if jo.employment_type == "Full-time" -%}
								<div class="py-1 px-2 full-time-badge">
									• {{ jo.employment_type }}
								</div>
								{%- elif jo.employment_type == "Part-time" -%}
								<div class="py-1 px-2 part-time-badge">
									• {{ jo.employment_type }}
								</div>
								{%- else -%}
								<div class="py-1 px-2 other-badge">
									• {{ jo.employment_type }}
								</div>
								{% endif %}
							</div>
						</div>
						{% endif %}
					</div>

					<!-- Job Details -->
					<div class="text-14">
						{%- if jo.location -%}
						<div class="mt-3 flex align-items-center">
							<svg
								class="icon ml-0 mr-1"
								xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 16 16"
							>
								<g stroke="var(--gray-700)" stroke-miterlimit="10">
									<path
										d="M11.467 3.458c1.958 1.957 1.958 5.088.027 7.02L7.97 14l-3.523-3.523a4.945 4.945 0 010-6.993l.026-.026a4.922 4.922 0 016.993 0zm0 0c-.026-.026-.026-.026 0 0z"
									></path>
									<path
										d="M7.971 8.259a1.305 1.305 0 100-2.61 1.305 1.305 0 000 2.61z"
									></path>
								</g>
							</svg>
							{{ jo.location }}
						</div>
						{% endif %}

						{%- if jo.department -%}
						<div class="mt-3 flex align-items-center">
							<svg
								class="icon ml-0 mr-1"
								style="--icon-stroke: var(--gray-700)"
							>
								<use href="#icon-branch"></use>
							</svg>
							{{ jo.department }}
						</div>
						{% endif %}

						{%- if jo.publish_salary_range -%}
						<div class="mt-3 flex align-items-center">
							<svg
								class="icon ml-0 mr-1"
								style="--icon-stroke: var(--gray-700)"
							>
								<use href="#icon-income"></use>
							</svg>
							&nbsp;
							{%- if jo.lower_range -%}
								{{ frappe.format_value(frappe.utils.flt(jo.lower_range), currency=jo.currency) }}
							{% endif %}
							{%- if jo.lower_range and jo.upper_range -%}
								{{ " - " }}
							{% endif %}
							{%- if jo.upper_range -%}
								{{ frappe.format_value(frappe.utils.flt(jo.upper_range), currency=jo.currency) }}
							{% endif %}
							/
							{{ jo.salary_per.lower() }}
						</div>
						{% endif %}
					</div>
				</div>

				<div class="px-4 py-2 job-card-footer mt-auto">
					<div class="row text-12 text-secondary">
						<p class="col-6 text-center mb-0 {{ 'border-right' if (jo.publish_applications_received or jo.closes_on) }}">
							{%- if jo.publish_applications_received -%}
								{{ _("Applications received:") + " " }}
								<b>{{ jo.no_of_applications }}</b>
							{% else %}
								‎
							{% endif %}
						</p>
						<p class="col-6 text-center mb-0">
							{%- if jo.closes_on -%}
								{{ _("Closes on:") + " " }}
								<b>{{ frappe.utils.format_date(jo.closes_on, "d MMM, YYYY") }}</b>
							{% endif %}
						</p>
					</div>
				</div>
			</div>
		</div>
		{% endfor %}
	</div>

	<!-- Pagination -->
	{%- if no_of_pages > 1 -%}
	<div class="mb-4 flex">
		<div
			class="btn-group mx-auto border rounded"
			role="group"
			aria-label="Pagination"
		>
			{% set page = frappe.form_dict.page %}
			{% set page = '1' if (not page or page|int > no_of_pages or page|int < 1) else page %}
			<button
				id="previous"
				class="btn btn-default border-right flex align-items-center bg-white"
			>
				<svg class="icon icon-sm" style="--icon-stroke: var(--gray-600)">
					<use href="#icon-left"></use>
				</svg>
			</button>

			<div class="flex bg-white">
				{% set initial_page = 1 if page|int == 1 else ((page|int / 3 + 0.5) | round(method='floor')|int * 3 - 2) %}
				{% set no_of_displayed_pages = 5 if no_of_pages - initial_page > 5 else no_of_pages - initial_page + 1 %}
				{% for i in range(no_of_displayed_pages) %}
					{% set pg = i + initial_page %}
					<button
						id="{{ pg }}"
						name="pagination"
						class="btn btn-default text-muted rounded-0"
						style="background-color: {{ 'var(--gray-100)' if pg|string == page else 'white' }}"
					>
						{% if (loop.first and pg != 1) or (loop.last and pg != no_of_pages) %}
						<span>...</span>
						{% else %}
						<span>{{ pg }}</span>
						{% endif %}
					</button>
				{% endfor %}
			</div>

			<button
				id="next"
				class="btn btn-default border-left flex align-items-center bg-white"
			>
				<svg class="icon icon-sm" style="--icon-stroke: var(--gray-600)">
					<use href="#icon-right"></use>
				</svg>
			</button>
		</div>
	</div>
	{% endif %}
</div>

	

{% endblock page_content %}
